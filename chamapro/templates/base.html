<!-- templates/base.html -->
{% load static %}
<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
    <!-- SEO: Basic Meta Tags -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    
    <!-- SEO: Page Title -->
    <title>{% block meta_title %}{{ meta_title|default:site_name }}{% endblock %}</title>
    
    <!-- SEO: Meta Description -->
    <meta name="description" content="{% block meta_description %}{{ meta_description|default:site_description }}{% endblock %}">
    
    <!-- SEO: Keywords -->
    <meta name="keywords" content="{% block meta_keywords %}{{ meta_keywords|default:site_keywords }}{% endblock %}">
    
    <!-- SEO: Author -->
    <meta name="author" content="{{ site_author }}">
    
    <!-- SEO: Canonical URL -->
    <link rel="canonical" href="{{ canonical_url }}">
    
    <!-- SEO: Open Graph (Facebook) -->
    <meta property="og:title" content="{% block og_title %}{{ meta_title|default:site_name }}{% endblock %}">
    <meta property="og:description" content="{% block og_description %}{{ meta_description|default:site_description }}{% endblock %}">
    <meta property="og:url" content="{{ canonical_url }}">
    <meta property="og:type" content="{{ og_type }}">
    <meta property="og:site_name" content="{{ site_name }}">
    <meta property="og:image" content="{% block og_image %}{{ og_image|default:site_url|add:'/static/img/chamapro-og.jpg' }}{% endblock %}">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:locale" content="en_US">
    
    <!-- SEO: Twitter Cards -->
    <meta name="twitter:card" content="{{ twitter_card }}">
    <meta name="twitter:site" content="@ChamaProKE">
    <meta name="twitter:title" content="{% block twitter_title %}{{ meta_title|default:site_name }}{% endblock %}">
    <meta name="twitter:description" content="{% block twitter_description %}{{ meta_description|default:site_description }}{% endblock %}">
    <meta name="twitter:image" content="{% block twitter_image %}{{ og_image|default:site_url|add:'/static/img/chamapro-twitter.jpg' }}{% endblock %}">
    
    <!-- SEO: Structured Data (JSON-LD) -->
    {% block structured_data %}{% endblock %}
    
    <!-- SEO: Favicon -->
    <link rel="icon" type="image/x-icon" href="{% static 'img/favicon.ico' %}">
    <link rel="apple-touch-icon" sizes="180x180" href="{% static 'img/apple-touch-icon.png' %}">
    
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
    
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    
    <!-- Custom CSS -->
    <link href="{% static 'css/style.min.css' %}" rel="stylesheet">
    
    <!-- SEO: Preload critical resources -->
    <link rel="preload" as="style" href="{% static 'css/style.min.css' %}">
    <link rel="preload" as="font" type="font/woff2" href="{% static 'fonts/poppins.woff2' %}" crossorigin>
    
    <!-- Additional CSS -->
    {% block extra_css %}{% endblock %}
    
    <!-- SEO: Google Analytics -->
    {% if not DEBUG %}
    <script async src="https://www.googletagmanager.com/gtag/js?id=GA_MEASUREMENT_ID"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'GA_MEASUREMENT_ID');
    </script>
    {% endif %}
</head>
<body class="d-flex flex-column min-vh-100">
    <!-- Skip to main content for accessibility -->
    <a href="#main-content" class="skip-link visually-hidden-focusable">Skip to main content</a>
    
    <!-- Navigation -->
    {% include 'includes/navbar.html' %}
    
    <!-- Main Content -->
    <main id="main-content" class="flex-grow-1">
        <!-- Messages -->
        {% if messages %}
        <div class="container mt-3">
            {% for message in messages %}
            <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
                {{ message }}
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
            {% endfor %}
        </div>
        {% endif %}
        
        <!-- Page Content -->
        {% block content %}{% endblock %}
    </main>
    
    <!-- Footer -->
    {% include 'includes/footer.html' %}
    
    <!-- Bootstrap JS Bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
    
    <!-- Custom JS -->
    <script src="{% static 'js/main.min.js' %}" defer></script>
    
    <!-- Additional JS -->
    {% block extra_js %}{% endblock %}
    
    <!-- SEO: Lazy loading for non-critical JS -->
    <script>
        // Lazy load images
        document.addEventListener("DOMContentLoaded", function() {
            var lazyImages = [].slice.call(document.querySelectorAll("img.lazy"));
            
            if ("IntersectionObserver" in window) {
                var lazyImageObserver = new IntersectionObserver(function(entries, observer) {
                    entries.forEach(function(entry) {
                        if (entry.isIntersecting) {
                            var lazyImage = entry.target;
                            lazyImage.src = lazyImage.dataset.src;
                            lazyImage.classList.remove("lazy");
                            lazyImageObserver.unobserve(lazyImage);
                        }
                    });
                });
                
                lazyImages.forEach(function(lazyImage) {
                    lazyImageObserver.observe(lazyImage);
                });
            }
        });
    </script>
</body>
</html>